{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/js/pages/remote-apis/remote-apis.js","webpack:///external \"jQuery\"","webpack:///./resources/js/pages/projects/project-sync.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","updateRemoteConnectionStatus","$container","apiId","$status","find","$","ajax","url","concat","window","TL","BASE_URL","type","dataType","getApiStatus","done","response","html","includes","removeClass","addClass","fail","PAGE","lang","errorText","e","Error","__webpack_exports__","CONNECT_MODAL_SELECTOR","initConnectRemoteApi","connectedCB","wrapper","document","createElement","classList","add","tabIndex","id","body","appendChild","on","event","$modal","this","relatedTarget","dataset","load","iframe","querySelector","src","currentTarget","result","location","reload","jQuery","jquery__WEBPACK_IMPORTED_MODULE_0__","jquery__WEBPACK_IMPORTED_MODULE_0___default","_remote_apis_remote_apis__WEBPACK_IMPORTED_MODULE_1__","$connectBtn","$connectionWrapper","$apiSelection","originalApiId","val","$projectSelect","updateConnection","then","urls","apiProjectList","remove","success","vals","each","project","status","remoteStatus","projectUrl","append","label","prop","error","getApiProjects"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,mBAIAlC,IAAAmC,EAAA,wCCpDO,SAASC,EAA6BC,EAAYC,GACvD,IAAMC,EAAUF,EAAWG,KAAK,sBAEhC,OAxBF,SAAsBF,GACpB,OAAOG,EAAEC,KAAK,CACZC,IAAG,GAAAC,OAAKC,OAAOC,GAAGC,SAAf,0BAAAH,OAAgDN,GACnDU,KAAM,MACNC,SAAU,SAoBLC,CAAaZ,GACjBa,KAAK,SAAAC,GACJb,EAAQc,KAAKD,GACTA,EAASE,SAAS,iBACpBjB,EAAWG,KAAK,uBAAuBe,YAAY,UAEnDlB,EAAWG,KAAK,uBAAuBgB,SAAS,YAGnDC,KAAK,WACJ,IAEElB,EAAQc,KAAR,4HAAAT,OAEIC,OAAOa,KAAKC,KAAKC,UAFrB,YAKA,MAAOC,GAGP,MAAM,IAAIC,MACR,gFAtDV9D,EAAAU,EAAAqD,EAAA,sBAAA3B,IAAApC,EAAAU,EAAAqD,EAAA,sBAAAC,IAAAhE,EAAAU,EAAAqD,EAAA,sBAAAE,IA+DO,IAAMD,EAAyB,yBAO/B,SAASC,EAAqBC,GACnC,IAAMC,EAAUC,SAASC,cAAc,OACvCF,EAAQG,UAAUC,IAAI,QAAS,QAC/BJ,EAAQK,UAAY,EACpBL,EAAQM,GAAKT,EACbI,SAASM,KAAKC,YAAYR,GAE1B1B,EAAC,IAAAG,OAAKoB,IAA0BY,GAAG,gBAAiB,SAASC,GAC3D,IACMC,EAASrC,EADCsC,MAGVzC,EADMuC,EAAMG,cACAC,QAAQ3C,MAO1BwC,EAAOI,KAAP,GAAAtC,OAAeC,OAAOC,GAAGC,SAAzB,qBAAAH,OAAqDN,GAAS,WAC5D,IAAM6C,EAASf,SAASgB,cAAc,wBAChCzC,EAAMwC,EAAOF,QAAQtC,IAC3BwC,EAAOE,IAAP,GAAAzC,OAAgBD,GAAhBC,OAAsBN,KAOxBwC,EAAOF,GAAG,gBAAiB,SAASC,GACS,YAAvCA,EAAMS,cAAcL,QAAQM,SACH,mBAAhBrB,EACTA,EAAY5B,GAIZO,OAAO2C,SAASC,QAAO,0BCzGjCtF,EAAAD,QAAAwF,yCCAA1F,EAAAkB,EAAA6C,GAAA,IAAA4B,EAAA3F,EAAA,GAAA4F,EAAA5F,EAAA6B,EAAA8D,GAAAE,EAAA7F,EAAA,KAWM8F,EAAcrD,IAAE,mBAChBsD,EAAqBtD,IAAE,uBACvBuD,EAAgBvD,IAAE,kBAClBwD,EAAgBD,EAAcE,MAGpC9B,SAASgB,cAAc,mBAAmBH,QAAQ3C,MAAQ2D,EAC1D,IAAME,EAAiB1D,IAAE,mBAOzB,SAAS2D,EAAiB9D,GACxBF,YAA6B2D,EAAoBzD,GAAO+D,KAAK,SAAAjD,GACtDA,EAASE,SAAS,kBAiC3B,SAAwBhB,GACtB,IAAMK,EAAG,GAAAC,OAAMc,KAAK4C,KAAKC,gBAAhB3D,OAAiCN,GAG1CG,IAAE,mBAAmB+D,SACrB/D,IAAE,eAAeyD,IAAI,IAErBzD,IAAEC,KAAK,CACLC,MACA8D,QAFK,SAEGC,GACNjE,IAAE,mBAAmB+D,SAErB/D,IAAEkE,KAAKD,EAAM,SAAStG,EAAGgD,GACvB,IAAMwD,EAAUxD,EAASwD,QACnBC,EAASzD,EAAS0D,aAClBC,EAAaF,EAAOlE,IAC1BwD,EAAea,OAAf,yCAAApE,OAC2CmE,EAD3C,MAAAnE,OAEIgE,EAAQK,MAFZ,gBAMFd,EAAee,KAAK,YAAY,IAElCC,MAAO,WACLhB,EAAee,KAAK,YAAY,MAzDhCE,CAAe9E,KASrB0D,EAAcpB,GAAG,SAAU,WACzBkB,EAAYtC,SAAS,UACrB,IAAMlB,EAAQG,IAAEsC,MAAMmB,MACtB9B,SAASgB,cAAc,mBAAmBH,QAAQ3C,MAAQA,EAC1D8D,EAAiB9D,KAOnB6D,EAAevB,GAAG,SAAU,WAC1B,IAAImC,EAAatE,IAAEsC,MAAMmB,MACN,IAAfa,IACFA,EAAa,MAEftE,IAAE,eAAeyD,IAAIa,KAwCvB9C,YAAqBmC,GACrBA,EAAiBH","file":"js/project-sync.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/resources/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 908);\n","/**\n * @file helper functions used by all pages that require connection with a remote API.\n */\n\n/**\n * Get the status of a Remote API. And get the DOM required to display it.\n * @param {number} apiId Identifier for the remote API to connect to.\n * @returns {node} DOM element containing the status of the API.\n */\nfunction getApiStatus(apiId) {\n  return $.ajax({\n    url: `${window.TL.BASE_URL}remote_api/status/web/${apiId}`,\n    type: \"GET\",\n    dataType: \"html\"\n  });\n}\n\n/**\n * Update the status of a remote API connection.  This updates the interface with the $container\n *\n * Expected DOM within the container:\n * <code>\n *   <div>\n *    <div class=\"js-status-wrapper\">  </div>\n *    <div class=\"oauth-connect-link\"></div>\n *   </div>\n * </code>\n * @param $container\n * @param apiId\n */\nexport function updateRemoteConnectionStatus($container, apiId) {\n  const $status = $container.find(\".js-status-wrapper\");\n\n  return getApiStatus(apiId)\n    .done(response => {\n      $status.html(response);\n      if (response.includes(\"invalid_token\")) {\n        $container.find(\".oauth-connect-link\").removeClass(\"hidden\");\n      } else {\n        $container.find(\".oauth-connect-link\").addClass(\"hidden\");\n      }\n    })\n    .fail(() => {\n      try {\n        // Update the DOM with an error message.\n        $status.html(\n          `<span class=\"status-label api-error label label-danger\"><i class=\"fa fa-exclamation-triangle spaced-right__sm fa-fw\"></i>${\n            window.PAGE.lang.errorText\n          }</span>`\n        );\n      } catch (e) {\n        // Since this code is loaded onto multiple pages, this error is thrown so the developer\n        // will be reminded ot add that to the page.\n        throw new Error(\n          \"Expected window to have Object `PAGE` with `lang.errorText` as a property\"\n        );\n      }\n    });\n}\n\n/*\n * Set up a modal to connect to the remote API.\n */\nexport const CONNECT_MODAL_SELECTOR = \"remote-connect-wrapper\";\n\n/**\n * Initialize the modal code on the page and set up callbacks.\n * @param {function} connectedCB Callback to be called after the API has been connected.\n *                   This usually updates the UI.\n */\nexport function initConnectRemoteApi(connectedCB) {\n  const wrapper = document.createElement(\"div\");\n  wrapper.classList.add(\"modal\", \"fade\");\n  wrapper.tabIndex = -1;\n  wrapper.id = CONNECT_MODAL_SELECTOR;\n  document.body.appendChild(wrapper);\n\n  $(`#${CONNECT_MODAL_SELECTOR}`).on(\"show.bs.modal\", function(event) {\n    const wrapper = this;\n    const $modal = $(wrapper);\n    const btn = event.relatedTarget;\n    const apiId = btn.dataset.apiId;\n\n    /*\n    In order to ensure proper setup of the modal, the content needs to be loaded dynamically\n    for each remote API.  Here we are loading the content of the modal and then setting the\n    src for the embedded iframe to point to the remote API.\n     */\n    $modal.load(`${window.TL.BASE_URL}remote_api/modal/${apiId}`, function() {\n      const iframe = document.querySelector(\"#oauth-connect-frame\");\n      const url = iframe.dataset.url;\n      iframe.src = `${url}${apiId}`;\n    });\n\n    /*\n    Since the modal content is loaded from and iframe, clicking a button in the iframe can only close the\n    modal window.  When the modal is closed the developer can pass a callback function to allow the updating of the UI.\n     */\n    $modal.on(\"hide.bs.modal\", function(event) {\n      if (event.currentTarget.dataset.result === \"success\") {\n        if (typeof connectedCB === \"function\") {\n          connectedCB(apiId);\n        } else {\n          // If no callback, reload the current page, without using the cache,\n          // to ensure that everything gets updated.\n          window.location.reload(true);\n        }\n      }\n    });\n  });\n}\n","module.exports = jQuery;","/**\n * @file Responsible for setting up new project synchronizations with a remote API.\n * Loaded onto pages/projects/project_sync.html\n */\n\nimport $ from \"jquery\";\nimport {\n  initConnectRemoteApi,\n  updateRemoteConnectionStatus\n} from \"../remote-apis/remote-apis\";\n\nconst $connectBtn = $(\"#connect-button\");\nconst $connectionWrapper = $(\".connection-wrapper\");\nconst $apiSelection = $(\"#api-selection\");\nconst originalApiId = $apiSelection.val();\n// jQuery .data(\"api-id\", id) does not write back to the DOM element for\n// vanilla js to query.\ndocument.querySelector(\"#connect-button\").dataset.apiId = originalApiId;\nconst $projectSelect = $(\"#project-select\");\n\n/**\n * Update the status of the connection to the remote api.  Used both to initial\n * the status of the connection and then to update once a connection has been made.\n * @param {number} apiId identifier the for the api to update.\n */\nfunction updateConnection(apiId) {\n  updateRemoteConnectionStatus($connectionWrapper, apiId).then(response => {\n    if (!response.includes(\"invalid_token\")) {\n      getApiProjects(apiId);\n    }\n  });\n}\n\n/**\n * Listen for changes in the api selection, and update the connection status / connect\n * button.\n */\n$apiSelection.on(\"change\", function() {\n  $connectBtn.addClass(\"hidden\");\n  const apiId = $(this).val();\n  document.querySelector(\"#connect-button\").dataset.apiId = apiId;\n  updateConnection(apiId);\n});\n\n/**\n * Listen for changes in the project selection based on the currently selected Remote API\n * and update the selected project value.\n */\n$projectSelect.on(\"change\", function() {\n  let projectUrl = $(this).val();\n  if (projectUrl === 0) {\n    projectUrl = null;\n  }\n  $(\"#projectUrl\").val(projectUrl);\n});\n\n/**\n * Get a list of project from the server for the currently selected remote api.\n * @param {number} apiId selected API identifier.\n */\nfunction getApiProjects(apiId) {\n  const url = `${PAGE.urls.apiProjectList}${apiId}`;\n\n  // Remove any current projects, they would be from a different API.\n  $(\".project-option\").remove();\n  $(\"#projectUrl\").val(\"\");\n\n  $.ajax({\n    url,\n    success(vals) {\n      $(\".project-option\").remove();\n\n      $.each(vals, function(i, response) {\n        const project = response.project;\n        const status = response.remoteStatus;\n        const projectUrl = status.url;\n        $projectSelect.append(\n          `<option class=\"project-option\" value=\"${projectUrl}\">${\n            project.label\n          }</option>`\n        );\n      });\n      $projectSelect.prop(\"disabled\", false);\n    },\n    error: function() {\n      $projectSelect.prop(\"disabled\", true);\n    }\n  });\n}\n\n/*\nInitialize the page.\n */\ninitConnectRemoteApi(updateConnection);\nupdateConnection(originalApiId);\n"],"sourceRoot":""}